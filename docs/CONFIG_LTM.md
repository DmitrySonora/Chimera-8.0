# Руководство по конфигурации (LTMActor)

**Файл:** config/settings_ltm.py

---

#### Коэффициент влияния зрелости профиля на порог

`LTM_MATURITY_IMPACT_FACTOR` - коэффициент влияния зрелости профиля на порог (по умолчанию: 0.1). Определяет максимальное повышение порога для молодых профилей: (final_threshold = base_threshold + (1 - base_threshold) * inverted_maturity * LTM_MATURITY_IMPACT_FACTOR). 0.1 = максимум +6% к порогу для новых пользователей. 

- Рекомендация: 0.05-0.15 для постепенной адаптации без резких скачков

#### Коэффициенты динамического порога новизны

`LTM_PERCENTILE_ADJUSTMENT_FACTOR` - коэффициент для расчета динамического порога от 90-го перцентиля (по умолчанию: 0.3). Определяет базовый порог сохранения как (profile.current_percentile_90 * LTM_PERCENTILE_ADJUSTMENT_FACTOR). Меньше значение = строже отбор, больше = мягче. 

- Рекомендация: 0.3 для отладки, 0.7 для продакшн

#### Эмоциональные пороги

`LTM_EMOTIONAL_THRESHOLD` - порог эмоциональной интенсивности для сохранения в долговременную память (по умолчанию: 0.6). Минимальное значение максимальной эмоции (кроме neutral) для триггера сохранения

  - 0.5 для ~5-10%, 0.6 для ~1-5% сообщений, 0.7 для ~0.5-2%
  - 0.4 - для наблюдения, 0.55- для продакшн

`LTM_EMOTIONAL_PEAK_THRESHOLD` - порог для определения эмоционального пика (по умолчанию: 0.8). Если любая эмоция превышает этот порог, событие считается эмоционально значимым. Рекомендация: 0.7-0.9 для баланса между чувствительностью и шумом

`LTM_EMOTIONAL_SHIFT_THRESHOLD` - порог для определения эмоционального сдвига (по умолчанию: 0.5). Минимальная разница между эмоциями для регистрации изменения. Рекомендация: 0.4-0.6 для отслеживания значимых перепадов

#### Типы памяти и ограничения

`LTM_MEMORY_TYPES` - допустимые типы воспоминаний (по умолчанию: ['self_related', 'world_model', 'user_related'])

- `self_related` - воспоминания о самой Химере, её идентичности
- `world_model` - знания о мире, фактах, концепциях
- `user_related` - информация о пользователе и взаимодействии с ним

`LTM_SCORE_MIN` - минимальное значение для всех score полей (по умолчанию: 0.0). Используется для валидации importance_score, emotional_intensity, self_relevance_score

`LTM_SCORE_MAX` - максимальное значение для всех score полей (по умолчанию: 1.0). Используется для валидации importance_score, emotional_intensity, self_relevance_score

`LTM_USER_ID_MAX_LENGTH` - максимальная длина user_id (по умолчанию: 255)

`LTM_MEMORY_TYPE_MAX_LENGTH` - максимальная длина типа памяти (по умолчанию: 50)

`LTM_TRIGGER_REASON_MAX_LENGTH` - максимальная длина причины сохранения (по умолчанию: 100)

`LTM_DOMINANT_EMOTIONS_MAX_SIZE` - максимальное количество доминирующих эмоций (по умолчанию: 10). Обычно достаточно 3-5 для характеристики эмоционального состояния

`LTM_SEMANTIC_TAGS_MAX_SIZE` - максимальное количество семантических тегов (по умолчанию: 20). Рекомендация: 10-20 тегов для баланса между детализацией и производительностью

`LTM_CONVERSATION_FRAGMENT_MAX_MESSAGES` - максимальное количество сообщений в фрагменте (по умолчанию: 10). Определяет размер контекстного окна вокруг триггерного сообщения. Больше = лучше контекст, но больше размер записи

`LTM_CONVERSATION_FRAGMENT_DEFAULT_WINDOW` - размер окна контекста по умолчанию (по умолчанию: 5). Количество сообщений до и после триггера для сохранения. Рекомендация: 3-7 сообщений для оптимального контекста

`LTM_MESSAGE_CONTENT_MAX_LENGTH` - максимальная длина контента сообщения (по умолчанию: 2000). При превышении сообщение обрезается. Рекомендация: 1500-2000 для сохранения контекста без перегрузки БД

#### Причины сохранения в LTM

`LTM_TRIGGER_REASONS` - список допустимых причин сохранения (по умолчанию: 7 причин)
**emotional_peak** - пиковое эмоциональное состояние (любая эмоция > 0.8)
**emotional_shift** - резкое изменение эмоционального состояния
**self_reference** - упоминание Химеры, вопросы о её природе
**deep_insight** - философские размышления, глубокие мысли
**personal_revelation** - важная личная информация пользователя
**relationship_change** - изменение в отношениях пользователя и Химеры
**creative_breakthrough** - особо удачная творческая генерация

`LTM_DEFAULT_ACCESS_COUNT` - начальное количество обращений к воспоминанию (по умолчанию: 0)

`LTM_DEFAULT_SELF_RELEVANCE_SCORE` - релевантность для самоидентификации (по умолчанию: None). None означает, что поле опционально и может не заполняться

#### Настройки LTMActor

`LTM_QUERY_TIMEOUT` - таймаут запросов к БД в секундах (по умолчанию: 5.0). Защита от зависших запросов при работе с большими объемами данных. Увеличить при медленной БД или сложных запросах

`LTM_METRICS_ENABLED` - включить сбор метрик (по умолчанию: True). Отключить в production для экономии ресурсов

`LTM_METRICS_LOG_INTERVAL` - интервал логирования метрик (по умолчанию: 300 c). Каждые 5 минут выводится статистика операций. Рекомендация: 300-600 с для баланса информативности и чистоты логов

`LTM_SCHEMA_CHECK_TIMEOUT` - таймаут проверки схемы БД в секундах (по умолчанию: 5.0). Время на проверку существования таблиц и индексов при инициализации

#### Параметры поиска в LTM

`LTM_SEARCH_MAX_LIMIT` - максимальное количество результатов за один поиск (по умолчанию: 100). Защита от чрезмерно больших выборок. Все методы поиска автоматически ограничивают limit этим значением

`LTM_SEARCH_DEFAULT_LIMIT` - количество результатов по умолчанию (по умолчанию: 10). Используется когда limit не указан явно в запросе. Оптимально для большинства сценариев использования

`LTM_SEARCH_TAGS_MODE_ANY` - режим поиска по тегам "хотя бы один" (по умолчанию: 'any'). Находит записи, содержащие хотя бы один из указанных тегов. SQL оператор: `semantic_tags && ARRAY[...]`

`LTM_SEARCH_TAGS_MODE_ALL` - режим поиска по тегам "все теги" (по умолчанию: 'all'). Находит записи, содержащие все указанные теги. SQL оператор: `semantic_tags @> ARRAY[...]`

`LTM_SEARCH_RECENT_DAYS_DEFAULT` - период поиска недавних воспоминаний в днях (по умолчанию: 7). Используется в методе `get_recent_memories` когда days не указан. Оптимально для недельного контекста взаимодействий

`LTM_SEARCH_MIN_IMPORTANCE_DEFAULT` - минимальная важность для поиска (по умолчанию: 0.8). Используется в методе `get_memories_by_importance` когда min_score не указан. Значение 0.8 соответствует высокой важности воспоминаний

---

## Настройки векторизации (Embeddings)

#### Модель и устройство

`LTM_EMBEDDING_MODEL` - модель для генерации embeddings (по умолчанию: `"sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2"`)
  - Мультиязычная модель, поддерживает русский язык
  - Генерирует 384-мерные векторы для текста
  - Альтернативы: `"sentence-transformers/all-MiniLM-L6-v2"` (английский, быстрее)

`LTM_EMBEDDING_DEVICE` - устройство для вычислений (по умолчанию: `"cpu"`)
    `"cpu"` - для систем без GPU
    `"cuda"` - для систем с NVIDIA GPU (ускорение в 5-10 раз)

`LTM_EMBEDDING_CACHE_DIR` - директория для кэша моделей (по умолчанию: `"./models/cache"`)
  - Модель загружается один раз и кэшируется
  - Размер кэша ~400MB для данной модели

#### Размерности композитного embedding
Общий размер: 768 измерений, разделенных на компоненты:

`LTM_EMBEDDING_SEMANTIC_DIM` - семантический компонент (по умолчанию: 384). Основной смысл текста сообщений. Получается напрямую из sentence-transformers

`LTM_EMBEDDING_EMOTIONAL_DIM` - эмоциональный компонент (по умолчанию: 128). Кодирует 28 эмоций из DeBERTa анализа. Расширяется через производные признаки

`LTM_EMBEDDING_TEMPORAL_DIM` - временной компонент (по умолчанию: 64). Кодирует время суток, день недели, месяц. Использует синусоидальное кодирование

`LTM_EMBEDDING_PERSONAL_DIM` - персональный компонент (по умолчанию: 192). Тип памяти (one-hot encoding). Семантические теги

#### Параметры векторизации
`LTM_EMBEDDING_BATCH_SIZE` - размер батча для обработки (по умолчанию: 32)

`LTM_EMBEDDING_MAX_LENGTH` - максимальная длина текста в символах (по умолчанию: 512). Тексты длиннее обрезаются перед векторизацией. Оптимально для баланса качества/скорости

`LTM_EMBEDDING_NORMALIZE` - нормализовать векторы (по умолчанию: True). True - векторы нормализуются к единичной длине. Необходимо для корректной работы cosine similarity в pgvector

#### Параметры генерации embeddings

`LTM_EMBEDDING_THREAD_POOL_SIZE` - размер пула потоков для асинхронной генерации векторов (по умолчанию: 2). Определяет количество параллельных потоков для генерации embeddings. Рекомендация: 2-4 для баланса между производительностью и потреблением памяти. Увеличение может ускорить обработку при большом потоке сообщений

`LTM_EMBEDDING_GENERATION_TIMEOUT` - таймаут генерации одного embedding  (по умолчанию: 10.0 с). Максимальное время ожидания генерации вектора перед отказом. Рекомендация: 5-15 секунд в зависимости от производительности системы

`LTM_EMBEDDING_REQUEST_TIMEOUT` - максимальное время ожидания генерации embedding (по умолчанию: 2.0). Если embedding не сгенерируется за это время, произойдет fallback на поиск типа 'recent'. Рекомендация: 1.5-3.0 секунд, учитывая что генерация использует ThreadPoolExecutor

`LTM_VECTOR_CACHE_TTL` - время жизни кэша результатов векторного поиска (по умолчанию: 3600). Кэширует результаты векторного поиска в Redis для идентичных запросов. Рекомендация: 1800-7200 секунд (30 мин - 2 часа) в зависимости от частоты обновления LTM

---

## Параметры аналитики LTM

`LTM_ANALYTICS_SIMILARITY_THRESHOLD` - поиск по эмоциональному сходству: минимальное косинусное сходство для поиска (по умолчанию: 0.7)

- Диапазон: 0.0-1.0, где 1.0 - идентичные эмоциональные состояния
- Рекомендуется 0.6-0.8 для поиска похожих настроений

`LTM_ANALYTICS_EMOTIONAL_SIMILARITY_LIMIT` - максимальное количество результатов (по умолчанию: 10). Ограничивает выборку для защиты от больших данных. Увеличьте для более широкого анализа

`LTM_ANALYTICS_PATTERN_MIN_OCCURRENCES` - детекция паттернов: минимум повторений для паттерна (по умолчанию: 3). Определяет порог для "устойчивого" паттерна

  - Меньше 3 - слишком шумно, больше 5 - пропустите редкие паттерны

##### Эмоциональные траектории
`LTM_ANALYTICS_TRAJECTORY_DEFAULT_DAYS` - временное окно анализа в днях (по умолчанию: 30). Стандартный период для построения эмоциональной динамики

`LTM_ANALYTICS_TRAJECTORY_DEFAULT_GRANULARITY` - детализация времени (по умолчанию: 'day'). Варианты: 'hour', 'day', 'week'

  - 'hour' - для детального анализа суточных ритмов
  - 'day' - стандартная динамика настроения
  - 'week' - долгосрочные тренды

##### Анализ концептуальных ассоциаций
`LTM_ANALYTICS_CONCEPT_ASSOCIATIONS_LIMIT` - лимит воспоминаний для анализа концепта (по умолчанию: 20). Ограничивает выборку при поиске ассоциаций. Баланс между полнотой анализа и производительностью

##### Определение трендов
`LTM_ANALYTICS_TREND_INCREASE_THRESHOLD` - порог роста эмоции (по умолчанию: 0.05). Минимальное среднее изменение для тренда "рост". 0.05 = рост на 5% между точками траектории

`LTM_ANALYTICS_TREND_DECREASE_THRESHOLD` - порог снижения эмоции (по умолчанию: -0.05). Максимальное среднее изменение для тренда "спад". -0.05 = снижение на 5% между точками

##### Поиск по настроению
`LTM_ANALYTICS_MOOD_MATCH_THRESHOLD` - минимальный вес для совпадения настроения (по умолчанию: 0.3). Взвешенное косинусное сходство с учетом emotional_intensity. 0.3 = умеренное совпадение, 0.5+ = сильное совпадение

##### Распределение важности
`LTM_ANALYTICS_HISTOGRAM_BUCKETS` - количество интервалов гистограммы (по умолчанию: 10). Для анализа распределения importance_score (0.0-1.0). Порог определения "аномально важных" воспоминаний. 10 buckets = интервалы по 0.1 (0-0.1, 0.1-0.2, ...)

`LTM_ANALYTICS_ANOMALY_STD_DEVS` - стандартные отклонения для аномалий (по умолчанию: 2). 2 σ = ~95% доверительный интервал, выбросы за его пределами

---

## Параметры оценки новизны

#### Веса факторов новизны (должны давать в сумме 1.0)
`LTM_NOVELTY_SEMANTIC_WEIGHT` - вес семантического расстояния в общей оценке (по умолчанию: 0.4). Определяет важность смысловой уникальности текста относительно существующих воспоминаний. Рекомендация: 0.35-0.45 для баланса между новыми темами и повторяющимися

`LTM_NOVELTY_EMOTIONAL_WEIGHT` - вес эмоциональной редкости (по умолчанию: 0.25). Учитывает насколько редки эмоции в контексте конкретного пользователя. Рекомендация: 0.2-0.3 для приоритета уникальных эмоциональных состояний

`LTM_NOVELTY_CONTEXT_WEIGHT` - вес редкости семантических тегов (по умолчанию: 0.2). Оценивает уникальность тематики на основе частотности тегов. Рекомендация: 0.15-0.25 в зависимости от разнообразия диалогов

`LTM_NOVELTY_TEMPORAL_WEIGHT` - вес временной новизны (по умолчанию: 0.15). Учитывает время с последнего обсуждения похожей темы. Рекомендация: 0.1-0.2 для естественного "забывания" старых тем

#### Параметры холодного старта
`LTM_COLD_START_BUFFER_SIZE` - количество сообщений для калибровки (по умолчанию: 20). Первые N сообщений накапливают статистику без сохранения в LTM. Рекомендация: 20-50 для адекватной начальной калибровки

`LTM_COLD_START_MIN_THRESHOLD` - минимальный порог новизны (по умолчанию: 0.8). Абсолютный минимум для сохранения даже после калибровки. Рекомендация: 0.75-0.85 для защиты от переполнения. 

- 0.4 для отладки, 0.8 для продакшн

`LTM_NOVELTY_SCORES_WINDOW` - размер окна последних оценок (по умолчанию: 90). Количество последних оценок для расчета динамического 90-го перцентиля. Рекомендация: 50-200 в зависимости от интенсивности общения

#### Параметры локальной плотности (KNN)
`LTM_KNN_NEIGHBORS` - количество ближайших соседей для оценки плотности (по умолчанию: 5). Определяет размер локального региона в пространстве embeddings. Рекомендация: 3-7 для баланса между локальностью и статистической значимостью

`LTM_KNN_DENSITY_THRESHOLD` - порог расстояния для "плотного" региона (по умолчанию: 0.2). Если среднее расстояние до соседей меньше порога - регион считается плотным. Рекомендация: 0.15-0.25 в зависимости от желаемой чувствительности

`LTM_KNN_DENSITY_PENALTY` - снижение веса в плотных регионах (по умолчанию: 0.3). На сколько уменьшается итоговая оценка новизны в переполненных областях. Рекомендация: 0.2-0.4 для предотвращения дублирования похожих воспоминаний

#### Пороги обработки эмоций
`LTM_EMOTION_FREQUENCY_THRESHOLD` - минимальное значение эмоции для учета (по умолчанию: 0.1). Эмоции ниже порога считаются шумом и не учитываются в частотностях. Рекомендация: 0.05-0.15 для фильтрации незначительных эмоций

`LTM_PERCENTILE_MIN_SAMPLES` - минимум оценок для расчета перцентиля (по умолчанию: 20). До накопления N оценок используется статический порог. Рекомендация: 15-30 для статистической достоверности

`LTM_MATURITY_SIGMOID_RATE` - скорость адаптации профиля (по умолчанию: 0.1). Определяет, как быстро снижается строгость отбора воспоминаний по мере развития отношений. Рекомендация: 0.05-0.1 для постепенной адаптации за 2-3 месяца, 0.15-0.2 для быстрой за месяц

---

## Метаданные для логики поиска

#### Приоритеты категорий (для определения search_type)

`LTM_TRIGGER_PRIORITIES` - приоритеты категорий триггеров для разрешения конфликтов (по умолчанию: словарь 1-5). Меньше число = выше приоритет. Определяет какой триггер сработает при множественном совпадении. Структура:
- `self_related` (высший приоритет, вопросы о Химере)  
- `unfinished_business`, `memory_recall` (высокий, нужны конкретные воспоминания)
- `uncertainty_doubt`, `emotional_resonance`, `temporal_acute` (средний)
- `existential_inquiry`, `pattern_recognition`, `metacognitive` (низкий)  
- `temporal_distant`, `contextual_amplifiers` (самый низкий)

#### Маппинг категорий на типы поиска

`LTM_CATEGORY_TO_SEARCH_TYPE` - маппинг категорий триггеров на типы поиска в LTM (по умолчанию: словарь). Определяет стратегию поиска после срабатывания триггера. Доступные типы: `'recent'`, `'importance'`, `'vector'`, `'self_related'`. Логика маппинга:
- **self_related** → 'self_related' (специализированный поиск по идентичности)
- **memory_recall, past_reference, temporal_acute** → 'recent' (недавние воспоминания)  
- **temporal_distant** → 'importance' (важные старые воспоминания)
- **unfinished_business, uncertainty_doubt, emotional_resonance, existential_inquiry, pattern_recognition, metacognitive, contextual_amplifiers** → 'vector' (семантический поиск)

---

## Настройки запросов к LTM
`LTM_REQUEST_TIMEOUT` - максимальное время ожидания ответа от LTM (по умолчанию: 0.5 с). Если LTM не ответит за это время, генерация продолжится только с STM контекстом. Рекомендация: 0.3-0.7 секунд для баланса между полнотой и скоростью ответа

`LTM_CONTEXT_LIMIT` - максимальное количество воспоминаний из LTM (по умолчанию: 3). Ограничивает объем контекста для предотвращения перегрузки модели. Рекомендация: 2-5 воспоминаний в зависимости от их типичной длины

`LTM_REQUEST_ENABLED` - глобальное включение/выключение LTM (по умолчанию: True). Позволяет быстро отключить интеграцию без изменения кода. Рекомендация: использовать для A/B тестирования или при проблемах с производительностью

`LTM_DEFAULT_SEARCH_TYPE` - тип поиска при отсутствии специфичных триггеров (по умолчанию: "recent"). Определяет стратегию поиска для общих триггеров памяти. 

- Доступные значения: "recent", "importance", "vector"

`LTM_EMOTIONAL_SEARCH_THRESHOLD` - порог эмоциональной интенсивности для активации поиска в LTM (по умолчанию: 0.7). При превышении автоматически запускается векторный поиск похожих эмоциональных контекстов. Работает независимо от текстовых триггеров, дополняя их эмоциональным слоем

---

## Основные параметры кэширования LTM
`LTM_CACHE_ENABLED` - включение Redis кэширования для LTM (по умолчанию: True). Глобальный переключатель для всей системы кэширования LTM. Рекомендация: отключать только при отладке или отсутствии Redis

`LTM_CACHE_KEY_PREFIX` - префикс для всех ключей кэша LTM (по умолчанию: "ltm"). Изолирует ключи LTM от других подсистем в Redis. Рекомендация: изменять только при конфликте с другими префиксами

`LTM_CACHE_DEFAULT_TTL` - время жизни кэша по умолчанию в секундах (по умолчанию: 1800). Используется для всех записей без явного TTL. Рекомендация: 1800-3600 сек (30-60 мин) для баланса между производительностью и актуальностью

#### Параметры кэширования результатов новизны
`LTM_NOVELTY_CACHE_TTL` - TTL для финальных результатов оценки новизны (по умолчанию: 1800 с). Время хранения комплексной оценки новизны (score + факторы). Рекомендация: 1800-3600 сек, увеличивать при стабильном профиле пользователя

`LTM_NOVELTY_CACHE_LOG_INTERVAL` - интервал логирования статистики кэша (по умолчанию: 100). Через сколько запросов выводить hit rate и статистику

  - Рекомендация: 100-500 для продакшн, 10-50 для отладки

#### Параметры кэширования промежуточных вычислений
`LTM_EMBEDDING_CACHE_TTL` - TTL для векторных представлений текста (по умолчанию: 3600 с). Embeddings неизменны для одного текста, можно хранить дольше. Рекомендация: 3600-7200 сек (1-2 часа) или больше при стабильной модели

`LTM_KNN_CACHE_TTL` - TTL для результатов поиска ближайших соседей (по умолчанию: 900 с). Инвалидируется при сохранении новых воспоминаний. Рекомендация: 600-1800 сек (10-30 мин) в зависимости от частоты новых воспоминаний

`LTM_TEMPORAL_CACHE_TTL` - TTL для временного анализа по тегам (по умолчанию: 1200 с). Инвалидируется при появлении воспоминаний с новыми тегами. Рекомендация: 900-1800 сек (15-30 мин) для актуальности временных паттернов

`LTM_PROFILE_CACHE_TTL` - TTL для полного профиля пользователя (по умолчанию: 21600 с). Содержит статистику эмоций, тегов, историю оценок новизны. Рекомендация: 14400-28800 сек (4-8 часов) для активных пользователей, можно увеличить для редких

`LTM_PERCENTILE_CACHE_TTL` - TTL для перцентилей порогов новизны (по умолчанию: 3600 с). Обновляется при каждом новом сообщении, критичен для точности оценки. Рекомендация: 1800-3600 сек (30-60 мин) для баланса актуальности и производительности

`LTM_CALIBRATION_CACHE_TTL` - TTL для статуса калибровки пользователя (по умолчанию: 7200 с). Меняется редко (только при переходе через порог в 10 сообщений). Рекомендация: 7200-14400 сек (2-4 часа) или больше, так как изменения редки

`LTM_CACHE_METRICS_ENABLED` - Включение сбора метрик кэширования (по умолчанию: True). Позволяет отслеживать эффективность кэша через события и логи. Рекомендация: True для production, можно отключить только при критичной нагрузке

`LTM_CACHE_HIT_RATE_ALERT` - Порог для предупреждения о низком hit rate (по умолчанию: 0.5). При падении hit rate ниже порога можно алертить (функционал для будущего мониторинга). Рекомендация: 0.4-0.6 в зависимости от паттернов использования системы

---

## Параметры политики хранения (Retention Policy)
`LTM_CLEANUP_ENABLED` - включение автоматической очистки (по умолчанию: True). True для продакшн, False для отладки или архивных систем. Рекомендация: True для контроля роста БД

`LTM_RETENTION_DAYS` - срок хранения воспоминаний в днях (по умолчанию: 365). Воспоминания старше этого срока становятся кандидатами на удаление

`LTM_RETENTION_MIN_IMPORTANCE` - минимальная важность для сохранения после срока (по умолчанию: 0.8). Воспоминания с importance ниже этого порога будут удалены. Рекомендация: 0.7-0.85 для баланса между объемом и ценностью

`LTM_RETENTION_CRITICAL_IMPORTANCE` - порог критической важности (по умолчанию: 0.95). Воспоминания выше этого порога НИКОГДА не удаляются. Рекомендация: 0.95-0.99 для сохранения только уникальных моментов

`LTM_RETENTION_MIN_ACCESS_COUNT` - минимум обращений для защиты от удаления (по умолчанию: 5). Часто используемые воспоминания сохраняются независимо от возраста. Рекомендация: 3-10 в зависимости от активности пользователей

#### Параметры выполнения очистки (Cleanup Execution)
`LTM_CLEANUP_BATCH_SIZE` - размер батча для удаления (по умолчанию: 1000). Меньше батч = меньше блокировок, больше батч = быстрее очистка. Рекомендация: 500-2000 в зависимости от производительности БД

`LTM_CLEANUP_QUERY_TIMEOUT` - таймаут запросов очистки в секундах (по умолчанию: 30.0). Защита от зависших запросов при больших объемах. Рекомендация: 20-60 сек в зависимости от размера таблиц

`LTM_CLEANUP_SCHEDULE_HOUR` - час запуска очистки UTC (по умолчанию: 3). Выбирайте время минимальной активности системы. Рекомендация: 2-5 часов UTC (ночь в Европе/России)

`LTM_CLEANUP_SCHEDULE_MINUTE` - минута запуска (по умолчанию: 0). Можно сместить для избежания конфликтов с другими задачами. Рекомендация: 0-30 для распределения нагрузки

`LTM_CLEANUP_DRY_RUN` - режим сухого прогона (по умолчанию: False). True = только логирование без реального удаления. Рекомендация: True для первого запуска в продакшн, затем False

#### Параметры генерации summary

`LTM_SUMMARY_ENABLED` - создавать ли агрегированные summary (по умолчанию: True). Summary сохраняют историческую статистику удаленных периодов. Рекомендация: True для сохранения исторического контекста

`LTM_SUMMARY_PERIOD` - период агрегации (по умолчанию: 'month'). Варианты: 'week', 'month', 'quarter'. Рекомендация: 'month' для баланса детализации и объема

`LTM_SUMMARY_MIN_MEMORIES` - минимум воспоминаний для создания summary (по умолчанию: 5). Меньше порог = больше summary, но менее значимые. Рекомендация: 3-10 в зависимости от активности пользователей

`LTM_SUMMARY_TOP_EMOTIONS` - количество топ эмоций в summary (по умолчанию: 5). Сохраняет N самых частых эмоций периода. Рекомендация: 5-10 для покрытия основного спектра

`LTM_SUMMARY_TOP_TAGS` - количество топ тегов в summary (по умолчанию: 10). Сохраняет N самых частых семантических тегов. Рекомендация: 10-20 для сохранения тематического контекста

#### Параметры инвалидации кэша
`LTM_CLEANUP_INVALIDATE_CACHE` - очищать ли кэши после cleanup (по умолчанию: True). Обеспечивает актуальность кэшированных данных novelty. Рекомендация: True для консистентности данных

`LTM_CLEANUP_INVALIDATE_PATTERNS` - паттерны кэша для очистки (по умолчанию: список). Указывает какие типы кэшей инвалидировать. Рекомендация: включить все типы novelty кэшей для полной очистки

#### Параметры логирования и мониторинга
`LTM_CLEANUP_LOG_LEVEL` - уровень логирования операций cleanup (по умолчанию: 'INFO'). DEBUG для отладки, INFO для продакшн, WARNING для минимального вывода. Рекомендация: INFO для баланса информативности и объема логов

`LTM_CLEANUP_EMIT_EVENTS` - генерировать ли события для Event Store (по умолчанию: True)

  - События позволяют отслеживать историю всех cleanup операций
  - Рекомендация: True для аудита и аналитики
